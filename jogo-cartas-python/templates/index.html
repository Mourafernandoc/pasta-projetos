<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Jogo de Cartas</title>
</head>
<body>
    <h1>Bem-vindo ao Jogo de Cartas!</h1>
    <div id="mao-jogador1">
        <!-- Cartas do Jogador 1 ser達o listadas aqui -->
    </div>
    <button id="iniciar-batalha">Iniciar Batalha</button>
    <button id="restart-batalha">Reiniciar Batalha</button>

    <div id="resultado"></div>
    <div id="placar">
        <h2>Placar</h2>
        <p>Jogador 1: <span id="pontos-jogador1">0</span></p>
        <p>Jogador 2: <span id="pontos-jogador2">0</span></p>
    </div>

    <script src="//code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.js"></script>
    <script>
        var socket = io.connect('http://' + document.domain + ':' + location.port);

        function atualizarCartas(cartas) {
            $('#mao-jogador1').empty();
            cartas.jogador1.forEach(function(carta) {
                $('#mao-jogador1').append(
                    '<input type="radio" name="carta" value="' + carta + '">' + carta + '<br>'
                );
            });

            if (cartas.jogador1.length === 0) {
                $('#mao-jogador1').html('<p>Sem cartas restantes</p>');
                $('#iniciar-batalha').prop('disabled', true);  // Desabilitar bot達o
            }
        }

        $('#iniciar-batalha').on('click', function() {
            var cartaSelecionada = $('#mao-jogador1').find('input[name="carta"]:checked').val();
            if (cartaSelecionada) {
                socket.emit('iniciar_batalha', { carta: cartaSelecionada });
            } else {
                alert('Por favor, selecione uma carta para iniciar a batalha.');
            }
        });

        $('#restart-batalha').on('click', function() {
            socket.emit('reiniciar_batalha');
            $('#resultado').empty();
            $('#pontos-jogador1').text(0);
            $('#pontos-jogador2').text(0);
            $('#iniciar-batalha').prop('disabled', false);  // Reativar bot達o ao reiniciar
        });

        socket.on('resultado_batalha', function(data) {
            $('#resultado').html(
                '<p>' + data.carta1 + ' VS ' + data.carta2 + '</p>' +
                '<p>Resultado: ' + data.resultado + '</p>'
            );
            atualizarCartas(data.cartas);
            $('#pontos-jogador1').text(data.placar.jogador1);
            $('#pontos-jogador2').text(data.placar.jogador2);
        });

        socket.on('fim_batalha', function(data) {
            $('#resultado').html('<h2>' + data.mensagem + '</h2>');
            $('#iniciar-batalha').prop('disabled', true);  // Desabilitar bot達o quando a batalha acabar
        });

        socket.on('cartas_iniciais', function(data) {
            atualizarCartas(data.cartas);
        });
    </script>
</body>
</html>
